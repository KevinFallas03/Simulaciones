/**********************************************************************************
Evaluacion 4 - Prueba de Series
Kevin Fallas Alvarado 2019057752
Esteban Madrigal Marin 2018154123

Chi Cuadrado prueba "80 Clase n=100" con 5 intervalos es de:
Chi Cuadrado prueba "90 AAA Pruieba Series n=1000" con 5 intervalos es de: 
Chi Cuadrado prueba "91 BBB Pruieba Series n=1000" con 5 intervalos es de: 
***********************************************************************************/

CLEAROUTPUT
/* OBTIENE FRECUENCIAS OBSERVADAS */
NEWCMD GET_FRECUENCIAS_OBSERVADAS lista_numeros cantidad_numeros intervalo cantidad_intervalos
   
   /* CREAR MATRIZ */
   NEWARRAY empty_matrix cantidad_intervalos cantidad_intervalos
   FOREACH row 1,cantidad_intervalos
      FOREACH col 1,cantidad_intervalos
         empty_matrix[row][col] = 0
      END
   END
   
   limite = cantidad_numeros - 1
   FOREACH id_num 1,limite
      
      /* OBTENEMOS EL PAR */
      TAKE lista_numeros id_num coordenada_x
      next = id_num+1
      TAKE lista_numeros next coordenada_y
      
      /* BUSCAMOS DONDE COLOCARLO */
      searching = true
      row = 1
      WHILE row <= cantidad_intervalos AND searching
         rango_y = intervalo*row
         col = 1
         WHILE col <= cantidad_intervalos AND searching
            rango_x = intervalo*col
            IF coordenada_x <= rango_x AND coordenada_y  <= rango_y
               empty_matrix[row][col] = empty_matrix[row][col]+1
               searching = false
            END
            col = col+1
         END
         row = row+1
      END
      row = 1
      col = 1
   END
   FOREACH row cantidad_intervalos,1
      FOREACH col 1,cantidad_intervalos
         OUTPUT "%5.3F  "empty_matrix[row][col]
      END
      OUTPUT "\n"
   END
END

/* OBTIENE FRECUENCIAS ESPERADAS */
NEWCMD GET_FRECUENCIA_ESPERADA lista_numeros cantidad_intervalos cantidad_numeros lista_fe
   denominador = cantidad_intervalosvalo * cantidad_intervalos
   frecuencia_esperada = (cantidad_numeros - 1) / (cantidad_intervalosvalo * cantidad_intervalos)
   COPY denominador#frecuencia_esperada lista_fe
END

/* IMPRIMIR TABLA DE LAS FRECUENCIAS OBSERVADAS */


/* MAIN */
READ lista_numeros
SIZE lista_numeros cantidad_numeros

INPUT cantidad_intervalos
intervalo = 1/cantidad_intervalos

GET_FRECUENCIAS_OBSERVADAS lista_numeros cantidad_numeros intervalo cantidad_intervalos
GET_FRECUENCIA_ESPERADA lista_numeros cantidad_intervalos cantidad_numeros lista_fe
getChiSquare fo lista_fe chiCuadrado
